```table-of-contents
title: ## Table of Contents
style: nestedList # TOC style (nestedList|nestedOrderedList|inlineFirstLevel)
minLevel: 0 # Include headings from the specified level
maxLevel: 3 # Include headings up to the specified level
includeLinks: true # Make headings clickable
debugInConsole: false # Print debug info in Obsidian console
```

![[vulnerability-assessment.png]]

> An analysis is a detailed explanation of an event or process, describing its origin and impact, that will the help of certain precautions and actions, can be triggered to support or prevent future occurrences.

 It is critical to either confirm or disprove our conclusions from our results & information. An example is: *we discover there is an open TCP port 2121 on a host during information gathering*.

We must distinguish between what we *see* and what we *have*
- A *TCP* port *2121* --> *TCP* means that the service is *connection-oriented*
- Is this a *standard* port? --> *No*, standard ports are between 0-1023, aka well-know or [system ports](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)
- Are there any numbers in this *port* that look *familiar*? --> *Yes*, *TCP* port *21* is *FTP*. So we should test (via Netcat or an FTP client) to see if this is a *FTP port in disguise*, confirming or disproving our conclusion.
- If upon connecting we realise it takes a while to connect, we can begin to guess why our initial *scan failed* --> potentially it timed-out? Try rerunning the scan on that target with a longer minimum timeout probe (`nmap --min-rtt-timeout`).

During this phase we are **using our information gathered & vulnerability research** to **look for known vulnerabilities, exploits, and security holes** that have already been reported. We can try searching for any [Common Vulnerabilities and Exposures (CVE)](https://www.cve.org/ResourcesSupport/FAQs) related to a service or application version. A few sources for this are:

| [CVEdetails](https://www.cvedetails.com/)                 | [Exploit DB](https://www.exploit-db.com/)               | [Vulners](https://vulners.com/) |
| --------------------------------------------------------- | ------------------------------------------------------- | ------------------------------- |
| [Packet Storm Security](https://packetstormsecurity.com/) | [NIST](https://nvd.nist.gov/vuln/search?execution=e2s1) |                                 |
Once we find a published vulnerability, we must understand what causes it and whether it could apply to our target.

## Performing a Network Vulnerability Assessment
1. *Conduct Risk Identification and Analysis* : Identify all assets part of an information system in a company. With this list, risks can be assigned to each component.
2. *Develop Vulnerability Scanning Policies* : The policy or a procedure should have an owner and be approved by upper management before taking effect.
3. *Identify the Types of Scans* : Identify which scans are most appropriate for each component to gain the most benefit.
4. *Configure the Scans* : Setup and configure the scans to ensure you are scanning the correct target with the correct scan parameters.
5. *Evaluate and Consider Possible Risks* : Consider if the scan could cause any risks to the system (eg. outages from the traffic generated).
6. *Perform the Scans* : Perform the scans and collect the results for further analysis.
7. *Interpret the Scan Results* : Identify the severity and remediation of the vulnerabilities discovered. Identify any false-positives too.
8. *Create a Remediation & Mitigation Plan* : A plan that identifies how each vulnerability will be addressed and its priorities and streamlining.

## Assessment of Possible Attack Vectors
We want to be performing some actual testing here, we are looking at historical information as well as current information we have discovered. It is also a very important part for evasive attacks to attempt to mimic the target locally as closely as you can so you can test freely without detection before trying exploits on the target.

## Asset Management
An *Asset Inventory* should be kept to ensure the organisation understands what assets are in the network and their protections and defences. Assets are commonly given data classifications which will dictate their protections, access controls and defences put in place. These data assets can include:
- All on-prem data (storage devices, endpoints such as PCs and mobile devices, flash media, tape drives etc)
- All data in cloud storage
- All data stored within SaaS applications (eg. Google Drive, Teams, Office 365)
- All applications used for business operations (eg. locally deployed, SaaS, cloud apps)
- All on-prem networking devices (eg. routers, switches, IDS/IPSs, firewalls)

## The Return
If we are unable to identify any potential vulnerabilities from our analysis, we want to return to the [[2 - Information Gathering]] stage and look in more detail. These two stages (*information gathering* and *vulnerability assessment*) often overlap and require us to move between them regularly.

The focus of a penetration test is quality and intensity, we are looking for ALL weaknesses, not just how fast we can compromise the target.