```table-of-contents
title: ## Table of Contents
style: nestedList # TOC style (nestedList|nestedOrderedList|inlineFirstLevel)
minLevel: 0 # Include headings from the specified level
maxLevel: 3 # Include headings up to the specified level
includeLinks: true # Make headings clickable
debugInConsole: false # Print debug info in Obsidian console
```

![[post-exploitation.png]]
The aim of this stage is to *obtain sensitive or security-relevant information* from a local perspective, and business-relevant information that requires higher privileges than standard.

## Evasive Testing
- Don't set off security alarms
- Worst case, we get kicked off the network and threat hunting against us begins
- We could lose access to a host or account.
- The pen test would fail but the success is the client detected our actions, still providing value by writing it all up and showing any gaps.
- Types of testing:
	- *Evasive* : trying to hide completely and find their blind-spots
	- *Hybrid-Evasive* : progressively get 'noisier' until we are detected to find what things can withstand
	- *Non-Evasive* : most in-depth test but requires us to not be bound by security measures

## [[2 - Information Gathering]]
As we are now in effectively a new environment, we should revisit the information gathering and vulnerability assessment stages. We previously only had external information, now we have internal information available for us to gather.

## Pillaging
Examine the role of each host on the network eg:

| Interfaces | Routing  | DNS             |
| ---------- | -------- | --------------- |
| ARP        | Services | VPN             |
| IP Subnets | Shares   | Network Traffic |
Alongside a host's role, we also want to know *how, why, and who it communicates with*. We can utilise applied policies to gather more information (eg. password criteria). We are also hunting for any sensitive information (credentials, scripts, config files etc).

## Persistence
Once we have an overview of the system, we need to immediate setup persisted access. This means we can return if the connection is interrupted. This step is essential and **should be done asap**.

Each attack, system, configuration, and admin are different so minimising the number of times we need to perform an exploit to get back will greatly help us, as well as potentially avoiding disruption (eg. if the exploit involved crashing things)

## Vulnerability Assessment
Now we have an overview and persistence, we want to repeat the vulnerability assessments, from an internal perspective this time. Our next goal is to escalate our privileges (if not already in place). It is essential that we distinguish between exploits that could harm the system and attacks that don't cause disruption.

## Privilege Escalation
Having the highest privileges is often crucial later on, so we are aiming for:
- *Linux* : `root`
- *Windows* : `administrator` / `local administrator` / `SYSTEM`
Allowing us to move through the system/network unrestricted.

Privilege escalation doesn't have to happen locally, we might just be able to steal some admin credentials.

## Data Exfiltration
Sometimes a client will want us to test if we can exfiltrate data, security systems like *Data Loss Prevention (DLP)* and *Endpoint Detection and Response (EDR)* help detect and prevent exfiltration.

Its important to check with the client on this one, we can also create some fake data and exfiltrate that to test the systems without using any real data.

|**Type of Information**|**Security Regulation**|
|---|---|
|Credit Card Account Information|`Payment Card Industry` (`PCI`)|
|Electronic Patient Health Information|`Health Insurance Portability and Accountability Act` (`HIPAA`)|
|Consumers Private Banking Information|`Gramm-Leach-Bliley` (`GLBA`)|
|Government Information|`Federal Information Security Management Act of 2002` (`FISMA`)|

Some frameworks companies may follow include:

| (`NIST`) - National Institute of Standards and Technology           | (`CIS Controls`) - Center for Internet Security Controls                   |
| ------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| (`ISO`) - International Organization for Standardization            | (`PCI-DSS`) - The Payment Card Industry Data Security Standard             |
| (`GDPR`) - General Data Protection Regulation                       | (`COBIT`) - Control Objectives for Information and Related Technologies    |
| (`FedRAMP`) - The Federal Risk and Authorization Management Program | (`ITAR`) - International Traffic in Arms Regulations                       |
| (`AICPA`) - American Institute of Certified Public Accountants      | (`NERC CIP Standards`) - NERC Critical Infrastructure Protection Standards |
Although we don't care about the specific data type, we do care about its required controls so its worth knowing how to protect each.