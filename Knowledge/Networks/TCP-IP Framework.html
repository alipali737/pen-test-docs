<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>TCP/IP Framework - Penetration Testing Notes</title> <link rel="shortcut icon" href="/pen-test-docs/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/pen-test-docs/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/pen-test-docs/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/pen-test-docs/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>TCP/IP Framework | Penetration Testing Notes</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="TCP/IP Framework" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <meta property="og:description" content="Documented notes and learning for penetration testing and related cyber security testing." /> <link rel="canonical" href="https://alipali737.github.io/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html" /> <meta property="og:url" content="https://alipali737.github.io/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html" /> <meta property="og:site_name" content="Penetration Testing Notes" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="TCP/IP Framework" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Documented notes and learning for penetration testing and related cyber security testing.","headline":"TCP/IP Framework","url":"https://alipali737.github.io/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_init.js"></script> <div class="side-bar"> <div class="site-header"> <a href="/pen-test-docs/" class="site-title lh-tight"> Penetration Testing Notes </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/" class="nav-list-link">Home</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/setting-up/setting-up.html" class="nav-list-link">Setting Up</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/setting-up/Logging.html" class="nav-list-link">CLI Logging</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Containers.html" class="nav-list-link">Containers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/operating-systems.html" class="nav-list-link">Operating Systems</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Screenshotting.html" class="nav-list-link">Screenshotting</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/useful-git-repos.html" class="nav-list-link">Useful Github Repos</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/virtual-private-servers.html" class="nav-list-link">Virtual Private Servers</a></li> <li class="nav-list-item"><a href="/pen-test-docs/setting-up/Virtualization.html" class="nav-list-link">Virtualization</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/Attacks%20Index.html" class="nav-list-link">Attacks</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/osint/OSINT%20Index.html" class="nav-list-link">Open-source Intelligence</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/osint/OSINT%20Framework.html" class="nav-list-link">OSINT Framework</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Index.html" class="nav-list-link">SQL Injection</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Introduction.html" class="nav-list-link">Introduction</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/Basic%20SQL%20Syntax.html" class="nav-list-link">Basic SQL Syntax</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/sql-injection/SQL%20Injection%20Cheatsheet.html" class="nav-list-link">SQL Injection Cheatsheet</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Attacks/web-application/Web%20Application%20Index.html" class="nav-list-link">Web Application</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Request%20Forgery%20(CSRF).html" class="nav-list-link">Cross-Site Request Forgery (CSRF)</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Cross-Site%20Scripting%20(XSS).html" class="nav-list-link">Cross-Site Scripting (XSS)</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Directory%20Enumeration%20Attack.html" class="nav-list-link">Directory Enumeration Attack</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Attacks/web-application/Server%20Side%20Includes%20(SSI%20Framework)%20(.shtml).html" class="nav-list-link">Server Side Includes (SSI Framework) (.shtml)</a></li> </ul> </li> </ul> </li> <li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Knowledge%20Index.html" class="nav-list-link active">Knowledge</a><ul class="nav-list"><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Networks/Networks%20Index.html" class="nav-list-link active">Networks</a><ul class="nav-list"><li class="nav-list-item active"><a href="/pen-test-docs/Knowledge/Networks/TCP-IP%20Framework.html" class="nav-list-link active">TCP/IP Framework</a></li> <li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Networks/Wireless%20Network%20Security.html" class="nav-list-link">Wireless Network Security</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Testing/Testing%20Index.html" class="nav-list-link">Testing</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Testing/Application%20Security%20Testing%20Methods.html" class="nav-list-link">Application Security Testing Methods</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Knowledge/Tools/Tools%20Index.html" class="nav-list-link">Tools</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Knowledge/Tools/Nmap.html" class="nav-list-link">Nmap</a></li> </ul> </li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Courses/Courses%20Index.html" class="nav-list-link">Courses</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Courses/Penetration%20Testing%20Fundamentals%20Bootcamp.html" class="nav-list-link">Penetration Testing Fundamentals Bootcamp</a></li> </ul> </li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/labs%20index.html" class="nav-list-link">Practice Labs</a><ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/overthewire/overthewire%20index.html" class="nav-list-link">OverTheWire</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/overthewire/Bandit.html" class="nav-list-link">Bandit Lab</a></li> </ul> </li> <li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/tryhackme/tryhackme%20index.html" class="nav-list-link">TryHackMe</a></li> <li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/pen-test-docs/Practice-Labs/vulnhub/vulnhub%20index.html" class="nav-list-link">VulnHub</a><ul class="nav-list"><li class="nav-list-item"><a href="/pen-test-docs/Practice-Labs/vulnhub/Empire%20-%20Breakout.html" class="nav-list-link">Empire: Breakout CTF</a></li> </ul> </li> </ul> </li> </ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Penetration Testing Notes" aria-label="Search Penetration Testing Notes" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/alipali737/pen-test-docs" class="site-button" > Github Source </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"> <a href="/pen-test-docs/Knowledge/Knowledge%20Index.html">Knowledge</a> </li><li class="breadcrumb-nav-list-item"> <a href="/pen-test-docs/Knowledge/Networks/Networks%20Index.html">Networks</a> </li><li class="breadcrumb-nav-list-item"> <span>TCP/IP Framework</span> </li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="tcpip-framework"> <a href="#tcpip-framework" class="anchor-heading" aria-labelledby="tcpip-framework"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TCP/IP Framework </h1> <details open=""> <summary class="text-delta"> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table of contents
</code></pre></div> </div> </summary> <ul id="markdown-toc"> <li><a href="#osi-model-simply-explained" id="markdown-toc-osi-model-simply-explained">OSI Model Simply Explained</a></li> <li><a href="#tcpip-model-simply-explained" id="markdown-toc-tcpip-model-simply-explained">TCP/IP Model Simply Explained</a> <ul> <li><a href="#tcp-vs-udp" id="markdown-toc-tcp-vs-udp">TCP vs UDP</a></li> </ul> </li> <li><a href="#packet-inspection" id="markdown-toc-packet-inspection">Packet Inspection</a> <ul> <li><a href="#stateless-inspection" id="markdown-toc-stateless-inspection">Stateless Inspection</a> <ul> <li><a href="#what-is-inspected" id="markdown-toc-what-is-inspected">What is inspected?</a></li> <li><a href="#use-cases" id="markdown-toc-use-cases">Use Cases</a></li> </ul> </li> <li><a href="#stateful-inspection" id="markdown-toc-stateful-inspection">Stateful Inspection</a> <ul> <li><a href="#sessions" id="markdown-toc-sessions">Sessions</a></li> </ul> </li> <li><a href="#using-both-stateful--stateless-together" id="markdown-toc-using-both-stateful--stateless-together">Using both Stateful &amp; Stateless together</a></li> </ul> </li> <li><a href="#ids-vs-ips-systems" id="markdown-toc-ids-vs-ips-systems">IDS vs IPS Systems</a> <ul> <li><a href="#ids---intrusion-detection-system" id="markdown-toc-ids---intrusion-detection-system">IDS - Intrusion Detection System</a></li> <li><a href="#ips---intrusion-prevention-system" id="markdown-toc-ips---intrusion-prevention-system">IPS - Intrusion Prevention System</a></li> <li><a href="#ips-defences" id="markdown-toc-ips-defences">IPS Defences</a></li> <li><a href="#detection-methods" id="markdown-toc-detection-methods">Detection Methods</a> <ul> <li><a href="#anomaly-based" id="markdown-toc-anomaly-based">Anomaly-Based</a></li> <li><a href="#signatures" id="markdown-toc-signatures">Signatures</a></li> <li><a href="#host-based-ids-h-ids" id="markdown-toc-host-based-ids-h-ids">Host-Based IDS (H-IDS)</a></li> <li><a href="#network-based" id="markdown-toc-network-based">Network-Based</a></li> </ul> </li> <li><a href="#firewall-filters" id="markdown-toc-firewall-filters">Firewall Filters</a></li> </ul> </li> <li><a href="#network-address-translation-nat" id="markdown-toc-network-address-translation-nat">Network Address Translation (NAT)</a> <ul> <li><a href="#types-of-nat" id="markdown-toc-types-of-nat">Types of NAT</a></li> </ul> </li> <li><a href="#local-area-networks" id="markdown-toc-local-area-networks">Local Area Networks</a> <ul> <li><a href="#network-addressing" id="markdown-toc-network-addressing">Network Addressing</a></li> <li><a href="#ethernet-networks" id="markdown-toc-ethernet-networks">Ethernet Networks</a> <ul> <li><a href="#mac-addresses" id="markdown-toc-mac-addresses">MAC Addresses</a></li> <li><a href="#communication-methods" id="markdown-toc-communication-methods">Communication Methods</a></li> </ul> </li> <li><a href="#network-devices-on-a-lan" id="markdown-toc-network-devices-on-a-lan">Network Devices on a LAN</a></li> <li><a href="#virtual-lans" id="markdown-toc-virtual-lans">Virtual LANs</a></li> <li><a href="#address-resolution-protocol-arp" id="markdown-toc-address-resolution-protocol-arp">Address Resolution Protocol (ARP)</a></li> <li><a href="#routing-tables" id="markdown-toc-routing-tables">Routing Tables</a></li> </ul> </li> </ul> </details><hr /> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     OSI MODEL              TCP/IP Layers
+---+-------------+      +---+-------------+
| 7 | Application |      | - | ~~~~~~~~~~~ |
| 6 | Presentation|      | 4 | Application |
| 5 | Session     |      | - | ~~~~~~~~~~~ |
| 4 | Transport   | &lt;--&gt; | 3 |  Transport  |
| 3 | Network     | &lt;--&gt; | 2 |   Network   |
| 2 | Data Link   | &lt;--&gt; | - |  -Network-  |
| 1 | Physical    | &lt;--&gt; | 1 |  Interface  |
+---+-------------+      +---+-------------+
</code></pre></div></div> <h2 id="osi-model-simply-explained"> <a href="#osi-model-simply-explained" class="anchor-heading" aria-labelledby="osi-model-simply-explained"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OSI Model Simply Explained </h2> <ul> <li><strong>Layer 1</strong>: Physical Layer - Responsible for the physical transportation of data as 0’s &amp; 1’s.</li> <li><strong>Layer 2</strong>: Data Link Layer - Responsible for routing packets using MAC addresses.</li> <li><strong>Layer 3</strong>: Network Layer - Responsible for routing packets using IP addresses.</li> <li><strong>Layer 4</strong>: Transport Layer - Handles the protocol used for transport of the packet, controls what happens if a packet does make it for example.</li> <li><strong>Layer 5</strong>: Session Layer - Handles starting, closing and managing sesisons. Session auth etc is established here.</li> <li><strong>Layer 6</strong>: Presentation Layer - Converts the data into formats usable by the application.</li> <li><strong>Layer 7</strong>: Application Layer - This is the actual application and it decides how it then displays the information.</li> </ul> <h2 id="tcpip-model-simply-explained"> <a href="#tcpip-model-simply-explained" class="anchor-heading" aria-labelledby="tcpip-model-simply-explained"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TCP/IP Model Simply Explained </h2> <ul> <li><strong>Layer 1</strong>: Network Access Layer - This layer sends and recieves the data at the local network level.</li> <li><strong>Layer 2</strong>: Internet Layer - This is where IP addresses and routing occurs.</li> <li><strong>Layer 3</strong>: Transport Layer - TCP &amp; UDP Protocols occur here.</li> <li><strong>Layer 4</strong>: Application Layer - This layer handles sessions, translating data, and the interaction of the content at the application level, eg. HTTP, FTP, or SMTP.</li> </ul> <h3 id="tcp-vs-udp"> <a href="#tcp-vs-udp" class="anchor-heading" aria-labelledby="tcp-vs-udp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TCP vs UDP </h3> <ul> <li><strong>TCP</strong> is a <em>connection-oriented</em> protocol, a much more rigorus acknowledgement between a sender and a receiver happens before any data is sent. This protocol includes flow control and error recovery, and should be used when important or large amounts of data is needed to be sent with timing being less of a concern.</li> <li><strong>UDP</strong> is a much more <em>lightweight</em> protocol that doesn’t require a fixed channel between the parties. It is often for less important data that just needs to be sent quickly.</li> </ul> <h2 id="packet-inspection"> <a href="#packet-inspection" class="anchor-heading" aria-labelledby="packet-inspection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Packet Inspection </h2> <h3 id="stateless-inspection"> <a href="#stateless-inspection" class="anchor-heading" aria-labelledby="stateless-inspection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stateless Inspection </h3> <ul> <li>Each packet is inspected one at a time, independently of any other packet knowledge</li> <li>No session tables are maintained, no database of previous packets inspected</li> <li>Much faster than stateful inspection, no need to check databases</li> </ul> <h4 id="what-is-inspected"> <a href="#what-is-inspected" class="anchor-heading" aria-labelledby="what-is-inspected"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> What is inspected? </h4> <ul> <li>Source IP address <ul> <li>Access Control List rule determins if an IP is allowed into the network or if dst IP is allowed to be accessed</li> </ul> </li> <li>Destination port / service</li> </ul> <h4 id="use-cases"> <a href="#use-cases" class="anchor-heading" aria-labelledby="use-cases"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Use Cases </h4> <ul> <li>To protect routing engine resources</li> <li>To control traffic going in or out your network</li> <li>For troubleshooting purposes when classifying packets</li> <li>To control traffic routing (through the use of routing instances)</li> <li>To perform QoS/CoS (marking traffic priorities)</li> </ul> <h3 id="stateful-inspection"> <a href="#stateful-inspection" class="anchor-heading" aria-labelledby="stateful-inspection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Stateful Inspection </h3> <ul> <li>Each packet is inspected with knowledge of all the previous packets in that session</li> </ul> <h4 id="sessions"> <a href="#sessions" class="anchor-heading" aria-labelledby="sessions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sessions </h4> <ul> <li>A session contains all the packets exchanged between the parties in an exchange</li> <li>Contains: <ul> <li>Src IP &amp; Port</li> <li>Dst IP &amp; Port</li> <li>[Optional] Instance Identifyer</li> </ul> </li> <li>A session ID can be used to locate the session information from the firewall packet database</li> </ul> <figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nv">$ </span>show security flow session application telnet
Session ID: 57866, Policy name: intrazone-Juniper-SV/4, Timeout: 3394, Valid
In: 172.20.107.10:56290 <span class="nt">--</span><span class="o">&gt;</span> 172.20.207.10:23<span class="p">;</span>tcp, If: vlan.107, Pkts: 27, Bytes: 1568
Out: 172.20.207.10.23 <span class="nt">--</span><span class="o">&gt;</span> 172.20.107.10:56290<span class="p">;</span>tcp, If: lt-0/0/0.1, Pkts: 21, Bytes: 1543</code></pre></figure> <h3 id="using-both-stateful--stateless-together"> <a href="#using-both-stateful--stateless-together" class="anchor-heading" aria-labelledby="using-both-stateful--stateless-together"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using both Stateful &amp; Stateless together </h3> <ul> <li>Stateless inspection is performed first</li> <li>Then Stateful data is evaluated</li> </ul> <h2 id="ids-vs-ips-systems"> <a href="#ids-vs-ips-systems" class="anchor-heading" aria-labelledby="ids-vs-ips-systems"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IDS vs IPS Systems </h2> <h4 id="ids---intrusion-detection-system"> <a href="#ids---intrusion-detection-system" class="anchor-heading" aria-labelledby="ids---intrusion-detection-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IDS - Intrusion Detection System </h4> <ul> <li>Network security technology originally built for detecting vulnerability exploits against a target application or computer.</li> <li>Listen-only device</li> <li>Most often, the IDS is a dedicated server that is connected to a port on a switch.</li> <li>The switch forwards a copy of all traffic to the IDS for inspection</li> <li>Monitors traffic (looking for anomolus behaviour) and then notifies an administrator</li> <li>Cannot automatically take action to prevent a detected exploit from taking over the system <blockquote> <p>Some modern IDS’ can run scripts, eg. that send a command to block an IP address to the router</p> </blockquote> </li> </ul> <h4 id="ips---intrusion-prevention-system"> <a href="#ips---intrusion-prevention-system" class="anchor-heading" aria-labelledby="ips---intrusion-prevention-system"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IPS - Intrusion Prevention System </h4> <ul> <li>Network security/threat prevention technology that examines network traffic to detect and prevent vulnerability exploits.</li> <li>IPS sits inline in a network, meaning all traffic MUST pass through it first before it can then move on (this adds a delay to the traffic)</li> <li>Positioned right after an edge device, router or firewall (Some firewalls are designed to act like an IPS)</li> <li>Unlike an IDS, the IPS actively analyzes packets, taking automated actions on all traffic flows that enter the network | | IPS | IDS | |-|-|-| | Placement in the network infrastructure | Part of the direct line of communication (inline) | Outside direct line of communication (offline) | | System Type | Active (monitors and automatically defends) and/or passive | Passive (monitors and notifies) | | Detection mechanism | Statistical anomaly-based detection; Signature detection: Explit-facing signature, Vulnerability-facing signature | Anomaly based |</li> </ul> <h3 id="ips-defences"> <a href="#ips-defences" class="anchor-heading" aria-labelledby="ips-defences"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IPS Defences </h3> <ul> <li>Can automatically create an ACL to block traffic that has been identified as malicious</li> <li>In passive mode, it will just notify the admin</li> </ul> <h3 id="detection-methods"> <a href="#detection-methods" class="anchor-heading" aria-labelledby="detection-methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Detection Methods </h3> <h4 id="anomaly-based"> <a href="#anomaly-based" class="anchor-heading" aria-labelledby="anomaly-based"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Anomaly-Based </h4> <ul> <li>Detect if a protocol’s standards are not being followed</li> <li>eg. Lots of half opened TCP sessions, HTTP arrives with an unexpectedly long header or missing headers</li> </ul> <h4 id="signatures"> <a href="#signatures" class="anchor-heading" aria-labelledby="signatures"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Signatures </h4> <ul> <li>Contain a database of signatures that are malicious</li> <li>Patterns that can be found in the payload of traffic</li> </ul> <h4 id="host-based-ids-h-ids"> <a href="#host-based-ids-h-ids" class="anchor-heading" aria-labelledby="host-based-ids-h-ids"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Host-Based IDS (H-IDS) </h4> <ul> <li>Software based solutions installed on a host to defend it from attack</li> <li>Listens to the traffic being recieved by or sent from the endpoint, and takes action/alerts where needed</li> </ul> <h4 id="network-based"> <a href="#network-based" class="anchor-heading" aria-labelledby="network-based"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network-Based </h4> <ul> <li>Hardware based</li> <li>IDS - sits on the side and recieved a copy of the traffic</li> <li>IPS - sits on the line and actively analyses traffic</li> </ul> <h3 id="firewall-filters"> <a href="#firewall-filters" class="anchor-heading" aria-labelledby="firewall-filters"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Firewall Filters </h3> <ul> <li>Many modern firewall designs have a <code class="language-plaintext highlighter-rouge">Control Plane</code> and a <code class="language-plaintext highlighter-rouge">Forwarding Plane</code></li> <li>The <strong>Forwarding Plane</strong> is responsible for all routing decisions, forwarding the packets on, policy evaluations, session matching etc</li> <li>The <strong>Control Plane</strong> runs the device operating system and holds the routing table, if this plane becomes unavailable the device can still forward traffic as the Plane’s are seperate</li> </ul> <h2 id="network-address-translation-nat"> <a href="#network-address-translation-nat" class="anchor-heading" aria-labelledby="network-address-translation-nat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Address Translation (NAT) </h2> <ul> <li>Translates an IP address on a network to another IP address to be used on a different network ( eg. internal IP (private host IP) –&gt; external IP (router IP for internet) )</li> <li>Router will read the Layer 3 information, <em>and if there is any NAT procedure</em>, it will modify the Src or Dst IP address</li> <li>Provides an additional layer of security, by preventing the real IP addresses of the systems on a network from being exposed across the internet</li> <li>Allows a network to expose a public IP address for each system OR just expose a single firewall IP address for the entire network</li> </ul> <h3 id="types-of-nat"> <a href="#types-of-nat" class="anchor-heading" aria-labelledby="types-of-nat"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Types of NAT </h3> <ul> <li><strong>Static</strong> address translation (Static NAT) : Allows for one-to-one mapping between local and global addresses.</li> <li><strong>Dynamic</strong> address translation (Dynamic NAT) : Maps unregistered IP addresses to registered IP addresses from a pool of registered IP addresses.</li> <li><strong>Overloading</strong> : Maps multiple unregistered IP addresses to a single registered address (many to one) using different ports (information is added in the Layer 4 data). This method is also known as Port Address Translation (PAT). By using overloading, thousands of users can be connected to the Internet by using only one real global IP address. Also requires the network to keep a database of the mappings.</li> </ul> <h2 id="local-area-networks"> <a href="#local-area-networks" class="anchor-heading" aria-labelledby="local-area-networks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Local Area Networks </h2> <h3 id="network-addressing"> <a href="#network-addressing" class="anchor-heading" aria-labelledby="network-addressing"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Addressing </h3> <ul> <li>Layer 2 : Data Link Layer <ul> <li>Uses MAC addresses</li> </ul> </li> <li>Layer 3 : Network Layer <ul> <li>Uses IP addresses</li> </ul> </li> </ul> <ol> <li>Data is encapsulated within a packet header</li> <li>Then the header is encapsulated within another header</li> <li>IP packet is then encapsulated in a Layer 2 frame (eg. ethernet frame)</li> <li>All encapsulated with physical information at Layer 1</li> <li>This is then reversed on the recieving end</li> </ol> <p><img src="/pen-test-docs/assets/images/networks/packet-address-information.png" alt="Packet Address Information" /></p> <p>| | Layer 2 Addresses | Layer 3 Addreses | |-|-|-| | Also known as | MAC Addresses; Hardware Addresses; Physical Addresses | IP Addresses; Logical Addresses | | Example | 00:90:96:9f:ea:46 | 172.16.12.1 | | Characteristics | Idenfity the stops made along the way; Change with each stop along the route | Identify the communicating computers or end points; Do not change (unless going through NAT) |</p> <blockquote> <p>Everytime a packet enters a new <strong>Layer 3</strong> device, the Layer 2 information is stripped out and replaced with new source and destination addreses</p> </blockquote> <h3 id="ethernet-networks"> <a href="#ethernet-networks" class="anchor-heading" aria-labelledby="ethernet-networks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Ethernet Networks </h3> <p><strong>Ethernet (IEEE 802.3) Frame Format:</strong></p> <div class="table-wrapper"><table> <thead> <tr> <th>Preamble</th> <th>SFD</th> <th>Dst Addr</th> <th>Src Addr</th> <th>Length</th> <th>Data</th> <th>Checksum/CRC</th> </tr> </thead> <tbody> <tr> <td>7 Bytes</td> <td>1 Byte</td> <td>6 Bytes</td> <td>6 Bytes</td> <td>2 Bytes</td> <td>46-1500 Bytes</td> <td>4 Bytes</td> </tr> </tbody> </table></div> <ul> <li><strong>Preamble</strong> - First 7 bytes of an Ethernet Frame, alternating between 0 and 1 allowing bit sync to happen and the reciever to lock onto the datastream before the actual frame bits start.</li> <li><strong>Start of frame delimiter (SFD)</strong> - 1-Byte field that is always set to <code class="language-plaintext highlighter-rouge">10101011</code>. This indicates the next bits are the destination address. Warns stations this is the last chance to sync. <blockquote> <p>The SFD is often described as part of the preamble, making it the first 8-bytes</p> </blockquote> </li> <li><strong>Dst Addr</strong> - Contains the MAC address of the machine it is destined.</li> <li><strong>Src Addr</strong> - MAC address of source machine. As Src Addr is always an individual address (Unicast), the least significant bit of first byte is always 0.</li> <li><strong>Length</strong> - Entire length of Ethernet frame, can be a 16-bit value between 0 and 65534. Data cannot be longer due to limitations of Ethernet.</li> <li><strong>Data</strong> - The Payload of the packet. Both IP header and data will be inserted here if Internet Protocol is used over Ethernet. Maximum length of 1500 bytes, and minimum of 46 bytes (0 padding will be added if data doesn’t meet minimum length)</li> <li><strong>Checksum/CRC (Cyclic Redundancy Check)</strong> - 32-bit hash code of the dst addr, src addr, length and data fields.</li> </ul> <p><strong>Recieving a packet</strong></p> <ol> <li><em>Layer 1</em> : Converts the signals to data and passes the frame to layer 2</li> <li><em>Layer 2</em> : Checks that the Dst MAC addr is the same as its own MAC addr, if so it strips off the layer 2 data and forwards the data as a packet to Layer 3</li> <li><em>Layer 3</em> : Checks that the Dst IP Addr is the same as its own, if so strips the L3 data and forwards to L4 <ul> <li>If Dst MAC or Dst IP addr doesn’t match the systems own addr the packet will be discarded as its not intended for that system</li> </ul> </li> </ol> <h4 id="mac-addresses"> <a href="#mac-addresses" class="anchor-heading" aria-labelledby="mac-addresses"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MAC Addresses </h4> <ul> <li>48-bit address that uniquly identifies every NIC.</li> <li>First 3 bytes are for the OUI and last 3 bytes are reserved to identify each NIC.</li> </ul> <p><strong>00:90:69:9f:ea:46</strong> example:</p> <ul> <li>00:90:69 - Identifies the manafacturer; Organizationally Unique Identifier (OUI)</li> <li>9f:ea:46 - Identifies the unique NIC</li> </ul> <h4 id="communication-methods"> <a href="#communication-methods" class="anchor-heading" aria-labelledby="communication-methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Communication Methods </h4> <ul> <li><strong>Unicast</strong> - 1-1 cast, only talking to one other device on a network <ul> <li>Uses MAC &amp; IP of dst device</li> </ul> </li> <li><strong>Broadcast</strong> - 1-All cast, sends a message to all devices on a network <ul> <li>Uses Maximum MAC Value (<code class="language-plaintext highlighter-rouge">FF:FF:FF:FF:FF:FF</code>) and boardcast IP address (<code class="language-plaintext highlighter-rouge">x.x.x.255</code> by default)</li> </ul> </li> <li><strong>Multicast</strong> - 1-Many cast, sends a message to all specified devices on a network <ul> <li>Devices can subscribe to an endpoint (a specific class-D range IP)</li> <li>The MAC address always begins with <code class="language-plaintext highlighter-rouge">01-00-5E</code> for multicast and the last 3 bytes are created by converting the lower 23 bits of the IP multicast group address into 6 hex characters.</li> </ul> </li> <li><strong>Half-duplex</strong> - Unable to transmit and recieve at the same time, traffic can only flow in one direction at a time.</li> <li><strong>Full-duplex</strong> - Can transmit and recieve data at the same time, traffic and flow in either direction at the same time.</li> </ul> <h3 id="network-devices-on-a-lan"> <a href="#network-devices-on-a-lan" class="anchor-heading" aria-labelledby="network-devices-on-a-lan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Network Devices on a LAN </h3> <ul> <li><strong>Hub</strong> - Takes the input data from one port and broadcasts it to all other ports on the network</li> <li><strong>Amplifier</strong> - Amplifies the input signal, this also amplifies any noise</li> <li><strong>Repeater</strong> - Takes the input signal and regenerates it, eliminating any noise in the signal</li> <li><strong>Bridge</strong> - Only sends the signal to the port the dst computer is connected too, it contains a MAC table so it knows where each device is in the network</li> <li><strong>Switch</strong> - Upgrade over the bridge, network loops are still an issue, they might not improve performance with multicast and broadcast traffic, cannot connect geographically dispersed networks</li> </ul> <div class="table-wrapper"><table> <thead> <tr> <th>Bridge</th> <th>Switch</th> </tr> </thead> <tbody> <tr> <td>Half-duplex data transmission</td> <td>Full-duplex data transmission</td> </tr> <tr> <td>End-user devices share bandwidth on each port</td> <td>Each port is dedicated to a single device; bandwidth is not shared</td> </tr> <tr> <td>Virtual LANs are not possible</td> <td>Virtual LANs are possible</td> </tr> </tbody> </table></div> <h3 id="virtual-lans"> <a href="#virtual-lans" class="anchor-heading" aria-labelledby="virtual-lans"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Virtual LANs </h3> <ul> <li>Logical seperation of devices in a network</li> <li>Could have 5 devices connected to a switch but you could create a VLAN containing 2 of the devices</li> </ul> <h3 id="address-resolution-protocol-arp"> <a href="#address-resolution-protocol-arp" class="anchor-heading" aria-labelledby="address-resolution-protocol-arp"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Address Resolution Protocol (ARP) </h3> <ul> <li>Used to find the MAC address of devices within the same broadcast domain</li> <li>Simply maps an IP (L3) address to a MAC (L2) Address</li> <li>Can be viewed using the following command</li> </ul> <figure class="highlight"><pre><code class="language-shell" data-lang="shell">arp <span class="nt">-a</span>
? <span class="o">(</span>9.140.101.1<span class="o">)</span> at 0:0:5e:0:1:1 on en0 ifscope <span class="o">[</span>ethernet]
? <span class="o">(</span>9.140.101.127<span class="o">)</span> at 88:66:5a:4d:e2:f4 on en0 ifscope permanent <span class="o">[</span>ethernet]
? <span class="o">(</span>224.0.0.251<span class="o">)</span> at 1:0:5e:0:0:fb on en0 ifscope permanent <span class="o">[</span>ethernet]
? <span class="o">(</span>239.255.255.250<span class="o">)</span> at 1:0:5e:7f:ff:fa on en0 ifscope permanent <span class="o">[</span>ethernet]</code></pre></figure> <ol> <li>Pings on the broadcast address to all devices on the network asking if they have the IP address being queried</li> <li>The device with that address will respond with its MAC address</li> </ol> <h3 id="routing-tables"> <a href="#routing-tables" class="anchor-heading" aria-labelledby="routing-tables"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Routing Tables </h3> <ul> <li>If we don’t know anything about the address it is sent to the default gateway by default which then routes it on</li> </ul> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">This page is being build from gh-pages at revision 356325f0939cd0b4bd7a9ff47d8bccd91b417980</p> </footer> </div> </div> <div class="search-overlay"></div> </div> <script type="text/javascript" src="/pen-test-docs/assets/js/toggle_mode.js"></script> </body> </html>
